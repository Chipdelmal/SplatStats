Docker Image
======================================

One of the main `SplatStats <https://chipdelmal.github.io/SplatStats/>`_ drawbacks as it stood up to now was that it needed the independent handling of the `s3s <https://github.com/frozenpandaman/s3s>`_ package to download data. 
The following updates described here were done to make some progress in alleviating this nuissance by bundling both packages together (as allowed by `s3s' licence <https://github.com/frozenpandaman/s3s#license--copyleft-statement->`_).


Setting Folder Structure Up
____________________________________________


Follow the instructions on `installing s3s locally <./quickstart.html#getting-s3s-up-and-running>`_. 
Once it has finished, we need to run s3s at least once, and to setup the following folder structure (the :code:`battles` and :code:`out` folders are auto-created, but the jsons one has to be created manually for now):

.. code-block:: bash

  data
    jsons
      config.txt
    battles
    out

Where :code:`data` is a dedicated folder for SplatStats' data and the :code:`config.txt` file is the one generated by `s3s <https://github.com/frozenpandaman/s3s>`_'s first run.
Once the package has been run successfully, we can do the rest from `SplatStat's docker image <https://hub.docker.com/r/chipdelmal/splatstats>`_!


Pulling Docker image
____________________________________________


If docker is `installed <https://docs.docker.com/get-docker/>`_ in the user's computer, the `image <https://hub.docker.com/r/chipdelmal/splatstats>`_ can easily be downloaded with:

.. code-block:: bash

  docker pull chipdelmal/splatstats


Running Image
____________________________________________

To run the image, navigate to the :code:`data` folder location and run the following command on the terminal:

.. code-block:: bash

  docker run \
    --net=host \
    --user "$(id -u):$(id -g)" \
    -v "$(pwd)":/data/ \
    splatstats:dev \
    --player "čħîþ ウナギ" --download True --upload False --overwrite True --weapon All


Replacing :code:`"čħîþ ウナギ"` with your Splatoon player name! 
If the :code:`config.txt` file is valid, the image will download your latest 50 battles JSON file, process it to extract the battles' serialized data, and output the resulting `plots <./plots.html>`_ to the :code:`out` directory.
Additionally, if you want your stats to be uploaded to `stat.ink <https://stat.ink/@chipdelmal>`_ you can simply replace :code:`--upload True`!

.. image:: ../img/statink.png
    :width: 100%

For more information on the code have a read on my `blogpost <https://chipdelmal.github.io/dataViz/2022-12-28-SplatStats2.html>`_!